<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.text.Text?>

<AnchorPane
        prefHeight="720.0" prefWidth="1200.0"
        style="-fx-background-color: #f0f4f0;"
        xmlns="http://javafx.com/javafx/21"
        xmlns:fx="http://javafx.com/fxml/1"
        fx:controller="Controllers.StatsDashboardController">

    <children>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             TOPBAR
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <HBox layoutX="0.0" layoutY="0.0"
              prefWidth="1200.0" prefHeight="68.0"
              alignment="CENTER_LEFT"
              style="-fx-background-color: white;
                     -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);">
            <padding><Insets top="0" left="24" right="24" bottom="0"/></padding>

            <!-- Bouton retour -->
            <Button fx:id="btnRetour"
                    mnemonicParsing="false" onAction="#retour"
                    prefHeight="36.0" prefWidth="110.0"
                    text="â† Retour"
                    style="-fx-background-color: #f0f4f0;
                           -fx-background-radius: 10;
                           -fx-text-fill: #228B22;
                           -fx-font-size: 13px;
                           -fx-font-weight: 600;
                           -fx-cursor: hand;
                           -fx-border-color: #228B22;
                           -fx-border-radius: 10;
                           -fx-border-width: 1.5;" />

            <!-- Titre -->
            <VBox alignment="CENTER_LEFT" spacing="2">
                <HBox.margin><Insets left="20"/></HBox.margin>
                <Label text="Tableau de bord â€” Statistiques"
                       style="-fx-font-size: 19px;
                              -fx-font-weight: bold;
                              -fx-text-fill: #1a1a1a;" />
                <Label fx:id="labelDerniereMaj"
                       text="DerniÃ¨re mise Ã  jour : --"
                       style="-fx-font-size: 11.5px; -fx-text-fill: #9ca3af;" />
            </VBox>

            <Region HBox.hgrow="ALWAYS" />

            <!-- Badge live -->
            <HBox alignment="CENTER" spacing="6"
                  style="-fx-background-color: #ecfdf5;
                         -fx-background-radius: 20;
                         -fx-border-color: #6ee7b7;
                         -fx-border-radius: 20;
                         -fx-border-width: 1;">
                <padding><Insets top="6" left="14" right="14" bottom="6"/></padding>
                <Pane prefWidth="8" prefHeight="8"
                      style="-fx-background-color: #16a34a; -fx-background-radius: 4;" />
                <Label text="En direct"
                       style="-fx-font-size: 12px; -fx-font-weight: 600; -fx-text-fill: #16a34a;" />
            </HBox>
        </HBox>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             CARTES KPI (rangÃ©e haute)
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <HBox layoutX="24.0" layoutY="88.0"
              spacing="18" prefWidth="1152.0">

            <!-- Carte Utilisateurs -->
            <VBox alignment="TOP_LEFT" spacing="10"
                  prefWidth="264.0" prefHeight="120.0"
                  style="-fx-background-color: white;
                         -fx-background-radius: 16;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);">
                <padding><Insets top="20" left="22" right="22" bottom="20"/></padding>
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <StackPane prefWidth="40" prefHeight="40"
                               style="-fx-background-color: #ecfdf5; -fx-background-radius: 10;">
                        <Label text="ðŸ‘¥" style="-fx-font-size: 18px;" />
                    </StackPane>
                    <Label text="Utilisateurs"
                           style="-fx-font-size: 13px; -fx-text-fill: #6b7280;" />
                </HBox>
                <Label fx:id="labelTotalUsers" text="0"
                       style="-fx-font-size: 36px; -fx-font-weight: bold; -fx-text-fill: #228B22;" />
                <HBox alignment="CENTER_LEFT" spacing="4">
                    <Label text="â–²"
                           style="-fx-font-size: 11px; -fx-text-fill: #16a34a;" />
                    <Label text="actifs sur la plateforme"
                           style="-fx-font-size: 11px; -fx-text-fill: #9ca3af;" />
                </HBox>
            </VBox>

            <!-- Carte Total TÃ¢ches -->
            <VBox alignment="TOP_LEFT" spacing="10"
                  prefWidth="264.0" prefHeight="120.0"
                  style="-fx-background-color: white;
                         -fx-background-radius: 16;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);">
                <padding><Insets top="20" left="22" right="22" bottom="20"/></padding>
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <StackPane prefWidth="40" prefHeight="40"
                               style="-fx-background-color: #eff6ff; -fx-background-radius: 10;">
                        <Label text="ðŸ“‹" style="-fx-font-size: 18px;" />
                    </StackPane>
                    <Label text="Total TÃ¢ches"
                           style="-fx-font-size: 13px; -fx-text-fill: #6b7280;" />
                </HBox>
                <Label fx:id="labelTotalTaches" text="0"
                       style="-fx-font-size: 36px; -fx-font-weight: bold; -fx-text-fill: #1976D2;" />
                <HBox alignment="CENTER_LEFT" spacing="4">
                    <Label text="â–²"
                           style="-fx-font-size: 11px; -fx-text-fill: #1976D2;" />
                    <Label text="toutes catÃ©gories"
                           style="-fx-font-size: 11px; -fx-text-fill: #9ca3af;" />
                </HBox>
            </VBox>

            <!-- Carte TÃ¢ches en cours -->
            <VBox alignment="TOP_LEFT" spacing="10"
                  prefWidth="264.0" prefHeight="120.0"
                  style="-fx-background-color: white;
                         -fx-background-radius: 16;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);">
                <padding><Insets top="20" left="22" right="22" bottom="20"/></padding>
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <StackPane prefWidth="40" prefHeight="40"
                               style="-fx-background-color: #fff7ed; -fx-background-radius: 10;">
                        <Label text="â³" style="-fx-font-size: 18px;" />
                    </StackPane>
                    <Label text="En cours"
                           style="-fx-font-size: 13px; -fx-text-fill: #6b7280;" />
                </HBox>
                <Label fx:id="labelTachesEnCours" text="0"
                       style="-fx-font-size: 36px; -fx-font-weight: bold; -fx-text-fill: #d97706;" />
                <HBox alignment="CENTER_LEFT" spacing="4">
                    <Label text="âš "
                           style="-fx-font-size: 11px; -fx-text-fill: #d97706;" />
                    <Label text="nÃ©cessitent attention"
                           style="-fx-font-size: 11px; -fx-text-fill: #9ca3af;" />
                </HBox>
            </VBox>

            <!-- Carte TÃ¢ches terminÃ©es -->
            <VBox alignment="TOP_LEFT" spacing="10"
                  prefWidth="264.0" prefHeight="120.0"
                  style="-fx-background-color: white;
                         -fx-background-radius: 16;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);">
                <padding><Insets top="20" left="22" right="22" bottom="20"/></padding>
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <StackPane prefWidth="40" prefHeight="40"
                               style="-fx-background-color: #f3e8ff; -fx-background-radius: 10;">
                        <Label text="âœ…" style="-fx-font-size: 18px;" />
                    </StackPane>
                    <Label text="TerminÃ©es"
                           style="-fx-font-size: 13px; -fx-text-fill: #6b7280;" />
                </HBox>
                <Label fx:id="labelTachesTerminees" text="0"
                       style="-fx-font-size: 36px; -fx-font-weight: bold; -fx-text-fill: #7c3aed;" />
                <HBox alignment="CENTER_LEFT" spacing="4">
                    <Label text="âœ“"
                           style="-fx-font-size: 11px; -fx-text-fill: #7c3aed;" />
                    <Label text="tÃ¢ches complÃ©tÃ©es"
                           style="-fx-font-size: 11px; -fx-text-fill: #9ca3af;" />
                </HBox>
            </VBox>

        </HBox>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             RANGÃ‰E GRAPHIQUES
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <HBox layoutX="24.0" layoutY="240.0"
              spacing="18" prefWidth="1152.0" prefHeight="410.0">

            <!-- PieChart â€” TÃ¢ches par rÃ´le -->
            <VBox spacing="0"
                  prefWidth="530.0"
                  style="-fx-background-color: white;
                         -fx-background-radius: 16;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);">

                <!-- En-tÃªte carte -->
                <HBox alignment="CENTER_LEFT" spacing="10" prefHeight="54.0">
                    <padding><Insets top="0" left="22" right="22" bottom="0"/></padding>
                    <StackPane prefWidth="32" prefHeight="32"
                               style="-fx-background-color: #ecfdf5; -fx-background-radius: 8;">
                        <Label text="ðŸ¥§" style="-fx-font-size: 15px;" />
                    </StackPane>
                    <VBox spacing="2">
                        <Label text="RÃ©partition par rÃ´le"
                               style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #1a1a1a;" />
                        <Label text="TÃ¢ches assignÃ©es par type d'utilisateur"
                               style="-fx-font-size: 11px; -fx-text-fill: #9ca3af;" />
                    </VBox>
                </HBox>

                <!-- SÃ©parateur -->
                <Pane prefHeight="1.0" prefWidth="530.0"
                      style="-fx-background-color: #f3f4f6;" />

                <!-- Graphique -->
                <PieChart fx:id="pieTachesParRole"
                          prefHeight="340.0" prefWidth="530.0"
                          labelsVisible="true"
                          legendVisible="true"
                          style="-fx-background-color: transparent;" />
            </VBox>

            <!-- BarChart â€” TÃ¢ches par statut -->
            <VBox spacing="0"
                  prefWidth="604.0"
                  style="-fx-background-color: white;
                         -fx-background-radius: 16;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);">

                <!-- En-tÃªte carte -->
                <HBox alignment="CENTER_LEFT" spacing="10" prefHeight="54.0">
                    <padding><Insets top="0" left="22" right="22" bottom="0"/></padding>
                    <StackPane prefWidth="32" prefHeight="32"
                               style="-fx-background-color: #eff6ff; -fx-background-radius: 8;">
                        <Label text="ðŸ“Š" style="-fx-font-size: 15px;" />
                    </StackPane>
                    <VBox spacing="2">
                        <Label text="TÃ¢ches par statut"
                               style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #1a1a1a;" />
                        <Label text="Distribution selon l'Ã©tat d'avancement"
                               style="-fx-font-size: 11px; -fx-text-fill: #9ca3af;" />
                    </VBox>

                    <Region HBox.hgrow="ALWAYS" />

                    <!-- LÃ©gende colorÃ©e -->
                    <HBox alignment="CENTER" spacing="14">
                        <HBox alignment="CENTER" spacing="5">
                            <Pane prefWidth="10" prefHeight="10"
                                  style="-fx-background-color: #228B22; -fx-background-radius: 3;" />
                            <Label text="TerminÃ©" style="-fx-font-size: 11px; -fx-text-fill: #228B22;" />
                        </HBox>
                        <HBox alignment="CENTER" spacing="5">
                            <Pane prefWidth="10" prefHeight="10"
                                  style="-fx-background-color: #d97706; -fx-background-radius: 3;" />
                            <Label text="En cours" style="-fx-font-size: 11px; -fx-text-fill: #6b7280;" />
                        </HBox>
                        <HBox alignment="CENTER" spacing="5">
                            <Pane prefWidth="10" prefHeight="10"
                                  style="-fx-background-color: #9ca3af; -fx-background-radius: 3;" />
                            <Label text="En attente" style="-fx-font-size: 11px; -fx-text-fill: #9ca3af;" />
                        </HBox>
                    </HBox>
                </HBox>

                <!-- SÃ©parateur -->
                <Pane prefHeight="1.0" prefWidth="604.0"
                      style="-fx-background-color: #f3f4f6;" />

                <!-- BarChart -->
                <BarChart fx:id="barTachesParStatut"
                          prefHeight="340.0" prefWidth="604.0"
                          legendVisible="false"
                          style="-fx-background-color: transparent;">
                    <xAxis>
                        <CategoryAxis label="Statut" />
                    </xAxis>
                    <yAxis>
                        <NumberAxis label="Nombre de tÃ¢ches" />
                    </yAxis>
                </BarChart>
            </VBox>

        </HBox>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             PIED DE PAGE
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <HBox layoutX="0.0" layoutY="668.0"
              prefWidth="1200.0" prefHeight="52.0"
              alignment="CENTER_LEFT"
              style="-fx-background-color: white;
                     -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.04), 6, 0, -2, 0);">
            <padding><Insets top="0" left="24" right="24" bottom="0"/></padding>

            <Label text="AgriGo  â€¢  Tableau de bord Statistiques"
                   style="-fx-font-size: 12px; -fx-text-fill: #9ca3af;" />

            <Region HBox.hgrow="ALWAYS" />

            <Button mnemonicParsing="false" onAction="#retour"
                    prefHeight="34.0" prefWidth="110.0"
                    text="â† Retour"
                    style="-fx-background-color: #228B22;
                           -fx-background-radius: 10;
                           -fx-text-fill: white;
                           -fx-font-size: 13px;
                           -fx-font-weight: 600;
                           -fx-cursor: hand;
                           -fx-effect: dropshadow(gaussian, rgba(34,139,34,0.30), 8, 0, 0, 3);" />
        </HBox>

    </children>
</AnchorPane>